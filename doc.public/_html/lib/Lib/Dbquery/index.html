<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dbquery (lib.Lib.Dbquery)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">lib</a> &#x00BB; <a href="../index.html">Lib</a> &#x00BB; Dbquery</nav><h1>Module <code>Lib.Dbquery</code></h1></header><dl><dt class="spec type" id="type-user"><a href="#type-user" class="anchor"></a><code><span class="keyword">type</span> user</code><code> = </code><code>{</code><table class="record"><tr id="type-user.id" class="anchored"><td class="def field"><a href="#type-user.id" class="anchor"></a><code>id : int;</code></td></tr><tr id="type-user.username" class="anchored"><td class="def field"><a href="#type-user.username" class="anchor"></a><code>username : string;</code></td></tr><tr id="type-user.password" class="anchored"><td class="def field"><a href="#type-user.password" class="anchor"></a><code>password : string;</code></td></tr><tr id="type-user.name" class="anchored"><td class="def field"><a href="#type-user.name" class="anchor"></a><code>name : string;</code></td></tr><tr id="type-user.friends" class="anchored"><td class="def field"><a href="#type-user.friends" class="anchor"></a><code>friends : <span>int list</span>;</code></td></tr><tr id="type-user.restrictions" class="anchored"><td class="def field"><a href="#type-user.restrictions" class="anchor"></a><code>restrictions : <span>int list</span>;</code></td></tr><tr id="type-user.groups" class="anchored"><td class="def field"><a href="#type-user.groups" class="anchor"></a><code>groups : <span>int list</span>;</code></td></tr></table><code>}</code></dt><dd><p>type user defines a type for each user</p></dd></dl><dl><dt class="spec type" id="type-group"><a href="#type-group" class="anchor"></a><code><span class="keyword">type</span> group</code><code> = </code><code>{</code><table class="record"><tr id="type-group.id" class="anchored"><td class="def field"><a href="#type-group.id" class="anchor"></a><code>id : int;</code></td></tr><tr id="type-group.name" class="anchored"><td class="def field"><a href="#type-group.name" class="anchor"></a><code>name : string;</code></td></tr><tr id="type-group.host_id" class="anchored"><td class="def field"><a href="#type-group.host_id" class="anchor"></a><code>host_id : int;</code></td></tr><tr id="type-group.members" class="anchored"><td class="def field"><a href="#type-group.members" class="anchor"></a><code>members : <span>int list</span>;</code></td></tr><tr id="type-group.voting_allowed" class="anchored"><td class="def field"><a href="#type-group.voting_allowed" class="anchor"></a><code>voting_allowed : bool;</code></td></tr><tr id="type-group.top_5" class="anchored"><td class="def field"><a href="#type-group.top_5" class="anchor"></a><code>top_5 : <span>string option</span>;</code></td></tr><tr id="type-group.top_pick" class="anchored"><td class="def field"><a href="#type-group.top_pick" class="anchor"></a><code>top_pick : <span>string option</span>;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-restriction"><a href="#type-restriction" class="anchor"></a><code><span class="keyword">type</span> restriction</code><code> = </code><code>{</code><table class="record"><tr id="type-restriction.id" class="anchored"><td class="def field"><a href="#type-restriction.id" class="anchor"></a><code>id : int;</code></td></tr><tr id="type-restriction.name" class="anchored"><td class="def field"><a href="#type-restriction.name" class="anchor"></a><code>name : string;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-add_user"><a href="#val-add_user" class="anchor"></a><code><span class="keyword">val</span> add_user : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_user username password_hash name</code> inserts a user in the database.</p></dd></dl><dl><dt class="spec value" id="val-add_friends"><a href="#val-add_friends" class="anchor"></a><code><span class="keyword">val</span> add_friends : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_friends friend1 friend2</code> inserts a pairing of two friends into the database based on their ids. Requires: friend1 and friend2 exist in the database</p></dd></dl><dl><dt class="spec value" id="val-add_restrictions"><a href="#val-add_restrictions" class="anchor"></a><code><span class="keyword">val</span> add_restrictions : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_restrictions user_id restriction_id</code> performs a restriction insertion into a table pairing a user and their dietary restriction. Requires: restriction_id and user_id exist in the database</p></dd></dl><dl><dt class="spec value" id="val-add_restrictions_index"><a href="#val-add_restrictions_index" class="anchor"></a><code><span class="keyword">val</span> add_restrictions_index : string <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_restrictions_index restriction_name</code> inserts a restriction into a table and associates it with an id.</p></dd></dl><dl><dt class="spec value" id="val-add_group_info"><a href="#val-add_group_info" class="anchor"></a><code><span class="keyword">val</span> add_group_info : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_group_info group_name host_id</code> inserts information about a group including the group name and host id into a table, associating the group with an id. Requires: the host_id must be the id of a user that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-delete_from_group"><a href="#val-delete_from_group" class="anchor"></a><code><span class="keyword">val</span> delete_from_group : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>delete_from_group group_id user_id host_id</code> deletes a user from a group, romoving all data from the group associated with that user. Requires: the group_id, user_id (member_id), and host_id, must be ids of a user and group respectively that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-reassign_host"><a href="#val-reassign_host" class="anchor"></a><code><span class="keyword">val</span> reassign_host : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>reassign_host group_id user_id host_id</code> changes the host of a group from the user associated with <code>host_id</code> to a different member of the group associated with <code>user_id</code>. Requires: the group_id, user_id (member_id), and host_id, must be ids of a user and group respectively that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-join_group"><a href="#val-join_group" class="anchor"></a><code><span class="keyword">val</span> join_group : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_groups user_id group_id</code> associates a group with a user, effectively putting a user into a group. Requires: the user_id and group_id must be ids of a user and group respectively that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-add_votes"><a href="#val-add_votes" class="anchor"></a><code><span class="keyword">val</span> add_votes : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int list</span> <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>add_votes group_id user_id restaurant_id_lst</code> adds users votes for a specific group Requires: <code>user_id</code> and <code>group_id</code> must be ids of a user and group respectively that exists in the database. <code>restaurant_id_lst</code> must contain all restaurant ids once in order of preference (front is first priority, last is least priority) stored in the database associated with that group.</p></dd></dl><dl><dt class="spec value" id="val-login"><a href="#val-login" class="anchor"></a><code><span class="keyword">val</span> login : string <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>login username</code> checks if user is in the database.</p></dd></dl><dl><dt class="spec value" id="val-ans_survey"><a href="#val-ans_survey" class="anchor"></a><code><span class="keyword">val</span> ans_survey : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>ans_survey user_id group_id loc_x loc_y cuisine price range</code> adds survey answers to the user's corresponding information in the groups table Requires: the user_id and group_id must be ids of a user and group respectively that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-calculate_votes"><a href="#val-calculate_votes" class="anchor"></a><code><span class="keyword">val</span> calculate_votes : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>calculate_votes g_id h_id</code> returns the id of the most preferred restaurant based on the rankings of users in group associated with <code>g_id</code> that voted. Requires: the group_id and host_id must be ids of a group and user respectively that exists in the database</p></dd></dl><dl><dt class="spec value" id="val-process_survey"><a href="#val-process_survey" class="anchor"></a><code><span class="keyword">val</span> process_survey : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p><code>process_survey g_id h_id</code> uses survey results from users in group associated with <code>g_id</code> to return a list of restaurants most closely matching users preferences.</p></dd></dl><dl><dt class="spec value" id="val-id_by_usr"><a href="#val-id_by_usr" class="anchor"></a><code><span class="keyword">val</span> id_by_usr : string <span>&#45;&gt;</span> int</code></dt><dd><p><code>id_by_usr usr</code> is the id of the user with unique username <code>usr</code></p></dd></dl><dl><dt class="spec value" id="val-get_user"><a href="#val-get_user" class="anchor"></a><code><span class="keyword">val</span> get_user : int <span>&#45;&gt;</span> <a href="index.html#type-user">user</a></code></dt><dd><p><code>get_user userid</code> is the user with <code>userid</code> Requires: <code>userid</code> is associated with a user that exists in the database.</p></dd></dl><dl><dt class="spec value" id="val-get_group"><a href="#val-get_group" class="anchor"></a><code><span class="keyword">val</span> get_group : int <span>&#45;&gt;</span> <a href="index.html#type-group">group</a></code></dt><dd><p><code>get_group groupid</code> is the group with <code>groupid</code> Requires: <code>groupid</code> is associated with a group that exists in the database.</p></dd></dl><dl><dt class="spec value" id="val-get_restriction_by_id"><a href="#val-get_restriction_by_id" class="anchor"></a><code><span class="keyword">val</span> get_restriction_by_id : int <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_restriction_by_id rest_id</code> is the restriction with <code>rest_id</code> Requires: <code>rest_id</code> is associated with a user that exists in the database.</p></dd></dl><dl><dt class="spec value" id="val-get_restrictions"><a href="#val-get_restrictions" class="anchor"></a><code><span class="keyword">val</span> get_restrictions : unit <span>&#45;&gt;</span> <span>string list</span></code></dt><dd><p><code>get_restrictions</code> gets a list of all restrictions that exist in the database</p></dd></dl><dl><dt class="spec value" id="val-create_tables"><a href="#val-create_tables" class="anchor"></a><code><span class="keyword">val</span> create_tables : unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_tables</code> creates all tables if they do not already exist in the database</p></dd></dl></div></body></html>